# Fuzzy Control - Lecture 7
# ุฃูุธูุฉ ุงูุงุณุชูุชุงุฌ ุงูุถุจุงุจู ู ANFIS

> **ุงููุฏู ุงูุฃุณุงุณู:** ุงูุชุฑููุฒ ุนูู ุงูููู ูุด ูุฌุฑุฏ ุงูุญูุธ  
> ูุฐุง ุงูููุถูุน ููู ุฌุฏุงู ูู ุงูุงูุชุญุงู ููู ููู ุงูุดุบู ุงูุนููู

---

## 1. ุฃุณุงุณูุงุช ุงูู Fuzzy Controller (ุงูุชุญูู ุงูุถุจุงุจู)

### ุงูููููู ุงูุฃุณุงุณู

ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ ูุฃู ูุธุงู ุชุญูู ุถุจุงุจู (Fuzzy Controller) ูู ุนูู **ุฎุฑูุทุฉ ุบูุฑ ุฎุทูุฉ (nonlinear mapping)** ุนุดุงู ูุญูู ูููุฉ ูุฏุฎูุงุช ุฑูููุฉ ูุงุถุญุฉ (Crisp Input) ุฅูู ูููุฉ ูุฎุฑุฌุงุช ุฑูููุฉ ูุงุถุญุฉ (Crisp Output). 

ุงููููุฉ ุงููุงุถุญุฉ (Crisp) ูุนูุงูุง ูููุฉ ุนุฏุฏูุฉ ุฃู ุญููููุฉ.

> **A Fuzzy Controller converts a crisp input into a crisp output using a nonlinear mapping.**

ุนูููุฉ ุงูุงุณุชูุชุงุฌ ุงูุถุจุงุจู (Fuzzy Inference) ุฏู ุจุชุดูู:
- ูู ุงูู **Membership Functions** (ุงููุฌููุนุงุช ุงูุถุจุงุจูุฉ)
- ุงูู **Operators** (ุงููุนุงููุงุช)
- ููุงุนุฏ **"ุฅุฐุง ูุงู... ูุฅู..."** (IF-THEN rules)

---

### ุฎุทูุงุช ุนูู ุงูู Fuzzy Controller

ุงูู Fuzzy Controller ุจูุดุชุบู ูู ุฎุทูุงุช ูุงุถุญุฉ (ููุง ูู ุงููุตุฏุฑ):

#### 1๏ธโฃ **Fuzzification (ุงูุถุจุงุจูุฉ)**
ุชุญููู ุงููุฏุฎูุงุช ุงูุฑูููุฉ ุงููุงุถุญุฉ ($I/P$) ุฅูู ุฏุฑุฌุงุช ุงูุชูุงุก ูููุฌููุนุงุช ุงูุถุจุงุจูุฉ.

#### 2๏ธโฃ **Inference Mechanism & Rules (ุขููุฉ ุงูุงุณุชูุชุงุฌ ูุงูููุงุนุฏ)**
ุงุณุชุฎุฏุงู ุงูููุงุนุฏ ุงูููุทููุฉ (IF-THEN rules) ูุชุญุฏูุฏ ููุฉ ุงููุงุนุฏุฉ ($w$) ูุชูููู ุงููุงุชุฌ ุงูุถุจุงุจู.

#### 3๏ธโฃ **Defuzzification (ุฅุฒุงูุฉ ุงูุถุจุงุจูุฉ)**
ุชุญููู ุงูููุงุชุฌ ุงูุถุจุงุจูุฉ ุงููุฌูุนุฉ ุฅูู ูููุฉ ุฑูููุฉ ูุงุถุญุฉ ($O/P$) ูููู ุงุณุชุฎุฏุงููุง ูู ุงูุชุญูู ($u$).

---

## 2. ุฃููุงุน ุฃูุธูุฉ ุงูุงุณุชูุชุงุฌ ุงูุถุจุงุจู (Types of Fuzzy Inference Systems)

ููู ุชูุงุช ุฃููุงุน ูุดููุฑุฉ ุฌุฏุงู ูุฃูุธูุฉ ุงูุงุณุชูุชุงุฌ ุงูุถุจุงุจู (FIS) ุฃู ุงููุชุญููุงุช ุงูุถุจุงุจูุฉุ ูุงูุงุชููู ุงูุฃูุซุฑ ุงุณุชุฎุฏุงูุงู ููุง Mamdani ู Sugeno:

1. **Mamdani fuzzy inference**
2. **Sugeno (or TSK) fuzzy inference**
3. **Tsukamoto fuzzy inference**

---

## 3. ุดุฑุญ ุฃููุงุน ุฃูุธูุฉ ุงูุงุณุชูุชุงุฌ ุงูุถุจุงุจู ุจุงูุชูุตูู

### (1) Mamdani Fuzzy Inference System

#### ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ (ุจุงูุนุฑุจูุฉ)

ูุธุงู Mamdani ูู ุงููุธุงู ุงูููุงุณูููุ ูุชู ุงูุชุฑุงุญู ูุฃูู ูุฑุฉ ููุชุญูู ูู ูุญุฑู ุจุฎุงุฑู ูุบูุงูุฉ ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ูู **ููุงุนุฏ ุงูุชุญูู ุงููุบููุฉ** ุงููู ุงุณุชุฎูุตููุง ูู ูุดุบู ุจุดุฑู ุฎุจูุฑ. 

ุฃูู ูุง ูููุฒ Mamdani ูู ุฃู ุงูุฌุฒุก ุจุชุงุน "ูุฅู" (THEN part) ูู ุงููุงุนุฏุฉ ูุงุฒู ูููู **ูุฌููุนุฉ ุถุจุงุจูุฉ (Fuzzy Set)**.

> **Mamdani is the classical system that uses linguistic rules and fuzzy sets in the rule consequence.**

---

#### ุดูู ุงููุงุนุฏุฉ (Rule Format)

ุงููุงุนุฏุฉ ุจุชููู ุจุงูุดูู ุฏู (ูุซู ูููุฐุฌ Mamdani ุจูุฏุฎููู ููุฎุฑุฌ ูุงุญุฏ):

$$R_i : \text{IF } x_1 \text{ is } A_i \text{ AND } x_2 \text{ is } B_i \text{ THEN } y \text{ is } C_i$$

(ุงูู $C_i$ ููุง ูู ุงุณู ููุฌููุนุฉ ุถุจุงุจูุฉ).

---

#### ููุน ุงููุฎุฑุฌุงุช (Output Type)

- **ูุงุชุฌ ูู ูุงุนุฏุฉ (Inferred Output):** **Fuzzy** (ุฏูุงู ุงูุชูุงุก ููุทูุนุฉ - Truncated Membership Functions)
- **ุงููุงุชุฌ ุงูููุงุฆู** ($y_{crisp}$): **Crisp** (ูููุฉ ุฑูููุฉ) ุจุนุฏ ุนูููุฉ ุงูุชุฌููุน (Aggregation) ูุฅุฒุงูุฉ ุงูุถุจุงุจูุฉ (Defuzzification)
- **ุทุฑููุฉ Defuzzification:** ุบุงูุจุงู ูุง ูุชู ุงุณุชุฎุฏุงู ุทุฑููุฉ **Center of Gravity (COG)**

---

#### ูุชู ูุณุชุฎุฏูู (Usage)

ูุณุชุฎุฏูู ููุง ูููู **ุงูุชูุณูุฑ ุงููุบูู ููููุงุนุฏ ููู** ุฃู ููุง ุชููู ุงูููุงุนุฏ ูุณุชูุฏุฉ ูู ุฎุจุฑุฉ ุฅูุณุงููุฉุ ุญูุซ ูุญุงูุธ ุนูู ุดูู ุงููุฌููุนุงุช ุงูุถุจุงุจูุฉ ุญุชู ุฎุทูุฉ ุงูู Aggregation.

---

#### ูุซุงู ุจุณูุท (Simple Intuitive Example)

ุนูุฏูุง ุชุฏุฎู ูููุชูู ูุงุถุญุชูู $I_1$ ู $I_2$ ูููุฏุฎูุงุช $x_1$ ู $x_2$:

1. ูุชู ุญุณุงุจ ููุฉ ุงููุงุนุฏุฉ ($w_1, w_2$) ุจุงุณุชุฎุฏุงู ูุนุงูู **Min** ุฃู **Product** ุจูู ุฏุฑุฌุงุช ุงูุงูุชูุงุก
2. ูุงุชุฌ ูู ูุงุนุฏุฉ ูู **ูุต (truncation)** ุฏุงูุฉ ุงูุงูุชูุงุก ูููุฎุฑุฌ ($C_i$) ุจููุฏุงุฑ ุงูููุฉ $w_i$
3. ุจุนุฏ ุชุฌููุน ูุฐู ุงูุฃุดูุงู ุงูุถุจุงุจูุฉ ุงูููุทูุนุฉุ ูุญุณุจ ุงูู **Center of Gravity** ููุญุตูู ุนูู ุงููููุฉ ุงูููุงุฆูุฉ ุงููุงุถุญุฉ ($y_{crisp}$)

---

### (2) Sugeno Fuzzy Inference System / TSK

#### ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ (ุจุงูุนุฑุจูุฉ)

ูุธุงู Sugeno (ุฃู TSK) ูุฎุชูู ูููุงู ุนู Mamdani ูู ุงูุฌุฒุก ุจุชุงุน "ูุฅู" (THEN part). 

ุจุฏูุงู ูู ูุฌููุนุฉ ุถุจุงุจูุฉุ **ุงููุงุชุฌ ูู ุฏุงูุฉ ุฑูุงุถูุฉ** (First-order polynomial) ูููุฏุฎูุงุช ุจุงูุฅุถุงูุฉ ูุซุงุจุช. 

ูุฐุง ุงูุชุบููุฑ ูุฌุนู TSK ุจุณูุทุงู ูู ุงูุญุณุงุจุงุช ูุณูู ุฏูุฌู ูุน ุทุฑู ุงูุชุญุณูู ูุงูุชุนูู ุงูุฐุงุชู (Optimization and self-adapting methods)ุ ููุฐูู ูู ุงูููุน ุงูุฐู ููุจูู ุนููู ูุธุงู ANFIS.

> **The Sugeno (TSK) model uses a first-order polynomial function in the consequence, which facilitates computation and optimization.**

---

#### ุดูู ุงููุงุนุฏุฉ (Rule Format)

ุงููุงุนุฏุฉ ุจุชููู ุจุงูุดูู ุฏู:

$$R_i : \text{IF } x_1 \text{ is } A_i \text{ AND } x_2 \text{ is } B_i \text{ THEN } y_i = p_i x_1 + q_i x_2 + r_i$$

(ุงูู $y_i$ ููุง ุฏุงูุฉ ุฎุทูุฉ ูููุฏุฎูุงุช $x_1$ ู $x_2$).

---

#### ููุน ุงููุฎุฑุฌุงุช (Output Type)

- **ูุงุชุฌ ูู ูุงุนุฏุฉ** ($y_i$): **Crisp** (ูููุฉ ุฑูููุฉ ูุงุถุญุฉ). ูุชู ุญุณุงุจูุง ุจุงูุชุนููุถ ุงููุจุงุดุฑ ูููู ุงููุฏุฎูุงุช $I_1, I_2$ ูู ุงูุฏุงูุฉ ุงูุฑูุงุถูุฉ
- **ุงููุงุชุฌ ุงูููุงุฆู** ($y_{crisp}$): **Crisp**ุ ููุชู ุงูุญุตูู ุนููู ุนู ุทุฑูู ุทุฑููุฉ **Weighted Average** (ุงููุชูุณุท ุงููุฑุฌุญ)
- **ุทุฑููุฉ Defuzzification:** Weighted Averageุ ูุชูุญุณุจ ุจุงููุนุงุฏูุฉ ุงูุชุงููุฉ:

$$y_{crisp} = \frac{w_1 y_1 + w_2 y_2}{w_1 + w_2}$$

---

#### ูุชู ูุณุชุฎุฏูู (Usage)

ูุณุชุฎุฏูู ููุง ูุญุชุงุฌ **ููุงุกุฉ ุญุณุงุจูุฉ ุนุงููุฉ** ูููุง ูุฎุทุท ูุชุฏุฑูุจ ุงููุธุงู ุฃู ุชุญุณููู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุงุช ุงูุชุนูู.

---

#### ูุซุงู ุจุณูุท (Simple Intuitive Example - Steam Engine)

ูุธุงู ูุญุฑู ุจุฎุงุฑู (Steam Engine System) ูุณุชุฎุฏู TSKุ ุญูุซ:
- $x_1$ ูู ุงูุณุฑุนุฉ
- $x_2$ ูู ุงูุถุบุท
- $y$ ูู ูุถุน ุงูุฎุงูู (Throttle Position)

**ูููุชุฑุถ ุฃู ุงููุฏุฎูุงุช:** $x_1 = 3$ ู $x_2 = 7$

##### ุฎุทูุงุช ุงูุญู:

1. **Fuzzification:**  
   ูุญุณุจ ุฏุฑุฌุงุช ุงูุงูุชูุงุก ุนูุฏ ูุฐู ุงูููู  
   (ูุซูุงู $\mu_{A1}(3) = 1$ ู $\mu_{B1}(7) = 0.5$)

2. **Rule Strengths** ($w_i$):  
   ูุญุณุจ ููุฉ ุงููุงุนุฏุฉ ุจุงูู Min  
   ูุซูุงู ูููุงุนุฏุฉ $R_1$: $w_1 = \min(1, 0.5) = 0.5$

3. **Crisp Rule Output** ($y_i$):  
   ูุนูุถ ูู ุงููุนุงุฏูุฉ ุงูุฎุงุตุฉ ุจุงููุงุนุฏุฉ  
   (ูุซูุงู $y_1 = 3 x_1 + 2 x_2 + 1$)  
   ุนูุฏ ุงูุชุนููุถ ($3 \times 3 + 2 \times 7 + 1$) ูุญุตู ุนูู $y_1 = 24$

4. **Defuzzification:**  
   ูุณุชุฎุฏู ุงููุชูุณุท ุงููุฑุฌุญ ููู ุงูููุงุชุฌ $y_i$ ุงููุฑุฌุญุฉ ุจููุชูุง $w_i$

---

### (3) Tsukamoto Fuzzy Inference System

#### ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ (ุจุงูุนุฑุจูุฉ)

ูู ูุธุงู Tsukamotoุ ุงููุงุชุฌ ูู ุงูู THEN part ูู ูุฌููุนุฉ ุถุจุงุจูุฉุ ููู ูุงุฒู ุชููู ูุฐู ุงูุฏุงูุฉ **ุฑุชูุจุฉ (Monotonic MF)**. 

ุงูุฑุชุงุจุฉ ุฏู ุจุชุฎูู ูู ููุฉ ูุงุนุฏุฉ ($w_i$) ูููุง ูููุฉ ูุงุญุฏุฉ ููุท ูู ุงููุฎุฑุฌ ($y_i$). 

ูุจูุง ุฅููุง ุจูุทูุน ูููุฉ ุฑูููุฉ ูุงุถุญุฉ ููู ูุงุนุฏุฉุ ุจููุฏุฑ ูุณุชุฎุฏู ุทุฑููุฉ **Weighted Average** ููู Defuzzificationุ ุชูุงูุงู ุฒู Sugeno.

> **Tsukamoto uses a monotonic membership function in the consequence part, allowing the use of weighted average for defuzzification.**

---

#### ุดูู ุงููุงุนุฏุฉ (Rule Format)

ุงููุงุนุฏุฉ ุจุชููู ุจุงูุดูู ุฏู:

$$R_i : \text{IF } x_1 \text{ is } A_i \text{ AND } x_2 \text{ is } B_i \text{ THEN } y \text{ is } C_i$$

(ุงูู $C_i$ ููุง ูุฌุจ ุฃู ุชููู ุฏุงูุฉ ุงูุชูุงุก ุฑุชูุจุฉ).

---

#### ููุน ุงููุฎุฑุฌุงุช (Output Type)

- **ูุงุชุฌ ูู ูุงุนุฏุฉ** ($y_i$): **Crisp** (ูููุฉ ุฑูููุฉ ูุงุถุญุฉ). ูุชู ุชุญุฏูุฏูุง ุจูุงุกู ุนูู ููุฉ ุงููุงุนุฏุฉ $w_i$ ูุงูุฏุงูุฉ ุงูุฑุชูุจุฉ
- **ุงููุงุชุฌ ุงูููุงุฆู** ($y_{crisp}$): **Crisp**ุ ููุชู ุญุณุงุจู ุนู ุทุฑูู **Weighted Average**

---

#### ูุชู ูุณุชุฎุฏูู (Usage)

ุนูู ุงูุฑุบู ูู ุฃู ุนูููุฉ ุฅุฒุงูุฉ ุงูุถุจุงุจูุฉ ููู ูุจุณุทุฉุ ุฅูุง ุฃู ูุธุงู Tsukamoto **ูุด ุจููุณุชุฎุฏู ูุชูุฑ ุฌุฏุงู**.

---

#### ูุซุงู ุจุณูุท (Simple Intuitive Example)

ุชุฎูู ุฏุงูุฉ ุงูุชูุงุก ูููุฎุฑุฌ "ุถุบุท ุนุงูู" ุจุชููู ุฑุชูุจุฉ (Monotonic). 

ุฅุฐุง ูุงูุช ููุฉ ุงููุงุนุฏุฉ $w_1 = 0.9$ุ ูุฅููุง ูุณุชุฎุฏู ุงูุฏุงูุฉ ุงูุฑุชูุจุฉ ููุฌุฏ ุงููููุฉ ุงูุฑูููุฉ ุงููุงุถุญุฉ ุงูููุงุจูุฉ ูุฏุฑุฌุฉ ุงูุงูุชูุงุก 0.9. 

ุจุนุฏ ุชุญุฏูุฏ $y_i$ ููู ูุงุนุฏุฉุ ูุฌูุน ุงูููุงุชุฌ ุงููุงุถุญุฉ ุฏู ุจุงุณุชุฎุฏุงู ุงููุชูุณุท ุงููุฑุฌุญ.

---

## 4. ุฃูุธูุฉ ANFIS (Adaptive Neuro-Fuzzy Inference System)

### (ุฃ) ุฃุณุงุณูุงุช ANFIS ูุงูุชุญูู ุงูุฐูู

ุงูู **ANFIS** ูู ูุธุงู ุถุจุงุจู ูุชู ุชุตูููู ุนูู ุดูู **ุดุจูุฉ ุนุตุจูุฉ ุงุตุทูุงุนูุฉ (ANN)**ุ ูุฏู ุจูุณูุญ ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุงุช ุงูุชุนูู ุนุดุงู ูุชู ุชุฏุฑูุจ ูุชุญุณูู ุงููุธุงู.

> **ANFIS models a fuzzy system using an artificial neural network structure to enable training and learning algorithms.**

---

#### ูุนูููุงุช ุฃุณุงุณูุฉ ุนู ANFIS

- **ุงูุงุณู:** ANFIS ุงุฎุชุตุงุฑ ูู **A**daptive **N**euro **F**uzzy **I**nference **S**ystem
- **ุงูููุน ุงููุนุชูุฏ ุนููู:** ุงูู ANFIS **ูุนุชูุฏ ุนูู ูุธุงู TSK** (Sugeno) ูุฃู TSK ุจุณูุท ูู ุงูุญุณุงุจุงุช ูุณูู ุฏูุฌู ูุน ุทุฑู ุงูุชุญุณูู ูุงูุชุนูู ุงูุฐุงุชู
- **ุงููุฏู:** ุงููุฏู ุงูุฃุณุงุณู ูู ANFIS ูู ุชุญุฏูุฏ **ุงูููู ุงููุซูู (Optimum Values)** ููุนุงููุงุช ูุธุงู TSK ุงูุถุจุงุจู ุงูููุงูุฆ

---

#### ุทุฑู ุงูุชุญุณูู (Optimization)

ุชุชู ุนูููุฉ ุงูุชุญุณูู (ุงูุชุฏุฑูุจ) ุนู ุทุฑูู ุชูููู ุงูุฎุทุฃ ุจูู ุงููุฎุฑุฌ ุงููุทููุจ ูุงููุฎุฑุฌ ุงููุนูู. ููููู ุงุณุชุฎุฏุงู:

##### 1๏ธโฃ ุทุฑู ุชุนุชูุฏ ุนูู ุงููุดุชูุงุช (Derivative-based)

- **Backpropagation (BP)**
- **Least Squares Estimate (LSE)**
- **Hybrid Learning (HL)** ุงููู ุจุชุฌูุน ูุง ุจูู ุงูุงุชููู

##### 2๏ธโฃ ุทุฑู ูุง ุชุนุชูุฏ ุนูู ุงููุดุชูุงุช (Derivative-free)

ุฎูุงุฑุฒููุงุช ุงูุญูุณุจุฉ ุงูุชุทูุฑูุฉ (Evolutionary Computation) ูุซู:
- **Genetic Algorithm (GA)**
- **Particle Swarm Optimization (PSO)**
- **Differential Evolution (DE)**

---

### (ุจ) ูุนุงููุงุช ANFIS ูุงูุชุฏุฑูุจ

ุงููุนุงููุงุช ุงูุชู ูุชู ุชุญุณูููุง (Tuning) ูู ูุธุงู ANFIS ุชููุณู ุฅูู ููุนูู:

#### 1๏ธโฃ ูุนุงููุงุช ุงูููุฏูุฉ (Premise Parameters)
ูุฏู ุจุชูุตู ุดูู ุฏูุงู ุงูุงูุชูุงุก (MFs) ูู ุฌุฒุก ุงูู IF (Antecedent).

#### 2๏ธโฃ ูุนุงููุงุช ุงููุชูุฌุฉ (Consequent Parameters)
ูุฏู ุจุชูุตู ุงููุฎุฑุฌ ุงูููู ููุธุงู TSK ูู ุฌุฒุก ุงูู THEN (Conclusion).

---

#### ุญุณุงุจ ุนุฏุฏ ุงููุนุงููุงุช (Exam Tip)

##### ุฅุฌูุงูู ุนุฏุฏ ุงูููุงุนุฏ (Rules)
ูู ุญุงุตู ุถุฑุจ ุนุฏุฏ ุงูู MFs ููู ูุฏุฎู  
(ูุซูุงู ูู ูุฏุฎูููุ ูู ูุงุญุฏ ููู 3 MFsุ ูุจูู 9 ููุงุนุฏ: $3 \times 3 = 9$)

##### ุนุฏุฏ ูุนุงููุงุช ุงูููุฏูุฉ (Premise Parameters)
(ุนุฏุฏ ูุนุงููุงุช ุงูุชุญูู ููู MF) * (ุฅุฌูุงูู ุนุฏุฏ ุงูู MFs)

(ูุซูุงู: ุฏุงูุฉ ูุซูุซูุฉ (triangular MF) ููุง 3 ูุนุงููุงุช ุชุญูู)

##### ุนุฏุฏ ูุนุงููุงุช ุงููุชูุฌุฉ (Consequent Parameters)
(ุนุฏุฏ ุงููุฏุฎูุงุช + 1) * (ุฅุฌูุงูู ุนุฏุฏ ุงูููุงุนุฏ)

---

#### ูุซุงู ุญุณุงุจู (Example EX2)

**ุงููุนุทูุงุช:**
- ุนุฏุฏ ุงููุฏุฎูุงุช: 3
- ูู ูุฏุฎู ุจู 5 ุฏูุงู ุงูุชูุงุก ูุซูุซูุฉ (Triangular MFs)

**ุงูุญู:**

| ุงูุจูุฏ | ุงูุญุณุงุจ | ุงููุชูุฌุฉ |
|-------|---------|---------|
| **ุนุฏุฏ ุงูููุงุนุฏ** | $5 \times 5 \times 5$ | **125** ูุงุนุฏุฉ |
| **ูุนุงููุงุช ุงูููุฏูุฉ (Premise)** | $3 \times (3 \times 5)$ | **45** ูุนุงูู |
| **ูุนุงููุงุช ุงููุชูุฌุฉ (Consequent)** | $(3 + 1) \times 125$ | **500** ูุนุงูู |
| **ุฅุฌูุงูู ูุนุงููุงุช ANFIS** | $45 + 500$ | **545** ูุนุงูู |

---

### (ุฌ) ูููู ANFIS (Layers)

ูููู ANFIS ูุชู ุชูุซููู ูุดุจูุฉ ุนุตุจูุฉ ูุชุนุฏุฏุฉ ุงูุทุจูุงุช (Multi-layered neural network).

> **The ANFIS structure is a multi-layered neural network where each layer performs a specific fuzzy inference step.**

---

#### Layer 0: Input Layer (ุทุจูุฉ ุงููุฏุฎูุงุช)

- **ุงููุธููุฉ:** ุชุณุชูุจู ุงููุฏุฎูุงุช ููุง ุชููู ุจุฃู ุนูููุฉ ุฃุฎุฑู

---

#### Layer 1: Fuzzification Layer (ุทุจูุฉ ุงูุถุจุงุจูุฉ)

- **ุงููุธููุฉ:** ุชููู ุจุนูููุฉ ุงูุถุจุงุจูุฉ (Fuzzification)
- **ุงููุงุชุฌ:** ุฏุฑุฌุฉ ุงูุงูุชูุงุก ($\mu$) ููู ูุฏุฎู ูู ูุทุงู

---

#### Layer 2: Rule Layer (ุทุจูุฉ ุงูููุงุนุฏ)

- **ุงููุธููุฉ:** ุชููุฐ ุนูููุฉ **AND** ุงูููุทููุฉ (ุจุงุณุชุฎุฏุงู Min ุฃู Product) ุจูู ุงููุฏุฎูุงุช
- **ุงููุงุชุฌ:** ูุงุชุฌ ูู ุนูุฏุฉ ูู ูุฐู ุงูุทุจูุฉ ููุซู ููุฉ ุงููุงุนุฏุฉ ($w_i$)

---

#### Layer 3: Normalization Layer (ุทุจูุฉ ุงูุชูุญูุฏ)

- **ุงููุธููุฉ:** ุชุญุณุจ ุงููุณุจุฉ ุจูู ููุฉ ุงููุงุนุฏุฉ ($w_i$) ููุฌููุน ููู ูู ุงูููุงุนุฏ ุงูุชู ุงุดุชุบูุช ($\sum w_i$)
- **ุงููุงุชุฌ:** ุงูููุฉ ุงูููุญุฏุฉ ($\bar{w}_i$)

$$\bar{w}_i = \frac{w_i}{\sum w_i}$$

---

#### Layer 4: Defuzzification Layer (ุทุจูุฉ ุฅุฒุงูุฉ ุงูุถุจุงุจูุฉ)

- **ุงููุธููุฉ:** ุชููุฐ ุงูุฌุฒุก ุงูุฎุงุต ุจุงููุชูุฌุฉ (Consequent part)
- **ุงููุงุชุฌ:** ุญุงุตู ุถุฑุจ ุงูููุฉ ุงูููุญุฏุฉ ($\bar{w}_i$) ูู ุงูุฏุงูุฉ ุงูุฎุทูุฉ ุงูููุงุจูุฉ ูููุชูุฌุฉ ($y_i$)

---

#### Layer 5: Sum Layer (ุทุจูุฉ ุงูุฌูุน)

- **ุงููุธููุฉ:** ุชุญุณุจ ุงููุฎุฑุฌ ุงููุงุถุญ ุงูููู ($y_{crisp}$) ูููุธุงู ุงูุถุจุงุจู ุนู ุทุฑูู ุฌูุน ูุฎุฑุฌุงุช ุงูุทุจูุฉ 4
- **ุงูุทุฑููุฉ:** ูุฐุง ุงูุฌูุน ููุซู ุทุฑููุฉ **Weighted Average**

$$y_{crisp} = \sum \bar{w}_i y_i$$

---

## 5. ูุตุงุฆุญ ููุงุฎุชุจุงุฑ ูุฃุฎุทุงุก ุดุงุฆุนุฉ

### ุฌุฏูู ุงููุตุงุฆุญ ูุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ

| ูุตูุญุฉ ุงูุชุญุงููุฉ (Exam Tip) | ุฎุทุฃ ุดุงุฆุน (Common Mistake) |
|:---------------------------|:--------------------------|
| **ุชูููุฒ ููุน ุงููุธุงู:** ุฏุงุฆููุง ุงูุธุฑ ุฅูู ุงูู **THEN part**. ุฅุฐุง ูุงูุช ูุนุงุฏูุฉ ุฑูุงุถูุฉ ($y_i = f(x)$)ุ ููู **TSK**. ุฅุฐุง ูุงูุช ูุฌููุนุฉ ุถุจุงุจูุฉ ($y$ is $C_i$)ุ ููู Mamdani ุฃู Tsukamoto. | **ุงูุฎูุท ุจูู COG ู Weighted Average:** Mamdani ูุณุชุฎุฏู COGุ ุฃูุง TSK ู Tsukamoto ูุณุชุฎุฏูุงู Weighted Average. |
| **TSK/ANFIS:** ุฅุฐุง ุทูุจ ููู ุญุณุงุจ $y_{crisp}$ุ ุชุฐูุฑ ุฃูู ุชุญุชุงุฌ ุฃู ุชุญุณุจ ุงูู $y_i$ ุฃููุงู ุจุงูุชุนููุถ ูู ุงููุนุงุฏูุฉุ ุซู ุชุณุชุฎุฏู Weighted Average. | **ูุณูุงู ูุนุงูู (+1):** ุนูุฏ ุญุณุงุจ ุนุฏุฏ ูุนุงููุงุช ุงููุชูุฌุฉ (Consequent Parameters)ุ ูุฌุจ ุถุฑุจ ุนุฏุฏ ุงูููุงุนุฏ ูู (ุนุฏุฏ ุงููุฏุฎูุงุช + 1). |
| **ูููู ANFIS:** ุงุญูุธ ุชุฑุชูุจ ููุธููุฉ ุฃูู 3 ุทุจูุงุช ุชุญุฏูุฏุงู (Input, Fuzzification, Rule) ูุถูุงู ุงูููู ุงูุตุญูุญ ูุณูุฑ ุงูุนูู. | **ุงูุฎูุท ุจูู ุทุจูุฉ 2 ู 3:** ุทุจูุฉ Rule Layer (2) ุชุญุณุจ ุงูููุฉ **$w_i$**. ุทุจูุฉ Normalization Layer (3) ุชุญุณุจ ุงูููุฉ **ุงูููุญุฏุฉ $\bar{w}_i$**. |

---

## 6. ุฌุฏูู ุงูููุงุฑูุฉ ุจูู ุฃูุธูุฉ ุงูุงุณุชูุชุงุฌ (Comparison Table)

| ุงูุฎุงุตูุฉ (Feature) | Mamdani | Sugeno (TSK) | Tsukamoto |
|:------------------|:--------|:-------------|:----------|
| **ุดูู ุงููุงุนุฏุฉ (THEN Part)** | ูุฌููุนุฉ ุถุจุงุจูุฉ (Fuzzy Set: THEN $y$ is $C_i$) | ุฏุงูุฉ ุฑูุงุถูุฉ (Function: THEN $y_i = f(\vec{x})$) | ูุฌููุนุฉ ุถุจุงุจูุฉ ุฑุชูุจุฉ (Monotonic MF: THEN $y$ is $C_i$) |
| **ูุงุชุฌ ุงููุงุนุฏุฉ ุงููุงุญุฏุฉ** | **ุถุจุงุจู (Fuzzy)** (ููุญูู ุงูุชูุงุก ููุทูุน) | **ุฑููู ูุงุถุญ (Crisp)** ($y_i$ ูุชู ุญุณุงุจูุง ูุจุงุดุฑุฉ) | **ุฑููู ูุงุถุญ (Crisp)** ($y_i$ ูู ุงูุงูุนูุงุณ ุนูู ุงูุฏุงูุฉ ุงูุฑุชูุจุฉ) |
| **ุทุฑููุฉ Defuzzification** | Center of Gravity (COG) | Weighted Average | Weighted Average |
| **ุงูููุงุกุฉ / ุงูุงุณุชุฎุฏุงู** | ููุชูุณูุฑ ุงููุบูู (Linguistic Interpretability) | ููููุงุกุฉ ุงูุญุณุงุจูุฉ ูุงูุชุญุณูู (Optimization), (ููุจูู ุนููู ANFIS) | ุบูุฑ ุดุงุฆุน ุงูุงุณุชุฎุฏุงู ูุซูุฑุงู |

---

### ๐ก ููุงุญุธุฉ ูููุฉ

> **ุชุฐูุฑ ุฃู:** TSK ู Tsukamoto ูุณุฑุนุงู ุนูููุฉ ุงูู Defuzzification ุจุงุณุชุฎุฏุงู Weighted Averageุ ูู ุญูู ุฃู Mamdani ูุทูุจ ุญุณุงุจ COG ุงูุฐู ูุญุชุงุฌ ุฅูู ุชุฌููุน ุงูููุญููุงุช ุงูุถุจุงุจูุฉ ุงูููุทูุนุฉ. 
> 
> ูุฐุง ูู ุงูุณุจุจ ุงูุฑุฆูุณู ูุชูุถูู TSK ูู ุชุทุจููุงุช ุงูุชุนูู ูุงูุชุญุณูู ูุซู ANFIS.

---

## ุฎูุงุตุฉ ุงููุญุงุถุฑุฉ

### ุงูููุงุท ุงูุฑุฆูุณูุฉ

1. โ **Fuzzy Controller** ูุญูู ุงููุฏุฎูุงุช ุงููุงุถุญุฉ ุฅูู ูุฎุฑุฌุงุช ูุงุถุญุฉ ุนุจุฑ ุฎุฑูุทุฉ ุบูุฑ ุฎุทูุฉ
2. โ **ุซูุงุซุฉ ุฃููุงุน ุฑุฆูุณูุฉ** ููุงุณุชูุชุงุฌ ุงูุถุจุงุจู: Mamdani, Sugeno (TSK), Tsukamoto
3. โ **Mamdani** ูุณุชุฎุฏู ูุฌููุนุงุช ุถุจุงุจูุฉ ูู THEN part ู COG ููู Defuzzification
4. โ **Sugeno (TSK)** ูุณุชุฎุฏู ุฏูุงู ุฑูุงุถูุฉ ูู THEN part ู Weighted Average ููู Defuzzification
5. โ **ANFIS** ูุนุชูุฏ ุนูู TSK ููุณุชุฎุฏู ูููู ุดุจูุฉ ุนุตุจูุฉ ููุชุฏุฑูุจ ูุงูุชุญุณูู
6. โ **ูุนุงููุงุช ANFIS** ุชููุณู ุฅูู: Premise Parameters ู Consequent Parameters
7. โ **ูููู ANFIS** ูุชููู ูู 6 ุทุจูุงุช (0-5) ููู ูููุง ูุธููุฉ ูุญุฏุฏุฉ

---

**Good luck! ๐ | ุจุงูุชูููู**
